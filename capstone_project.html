<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jason Rappazzo, James Jordan">
<meta name="dcterms.date" content="2023-05-15">

<title>DANL 399 - United States Car Accident Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">DANL 399</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./capstone_project.html" rel="" target="" aria-current="page">
 <span class="menu-text">project</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#indroduction" id="toc-indroduction" class="nav-link active" data-scroll-target="#indroduction"><span class="header-section-number">1</span> Indroduction</a>
  <ul class="collapse">
  <li><a href="#research-questions" id="toc-research-questions" class="nav-link" data-scroll-target="#research-questions"><span class="header-section-number">1.1</span> Research Questions</a></li>
  <li><a href="#overview-of-modeling-techniques" id="toc-overview-of-modeling-techniques" class="nav-link" data-scroll-target="#overview-of-modeling-techniques"><span class="header-section-number">1.2</span> Overview of Modeling Techniques</a></li>
  </ul></li>
  <li><a href="#raw-data" id="toc-raw-data" class="nav-link" data-scroll-target="#raw-data"><span class="header-section-number">2</span> Raw Data</a>
  <ul class="collapse">
  <li><a href="#about-the-data" id="toc-about-the-data" class="nav-link" data-scroll-target="#about-the-data"><span class="header-section-number">2.1</span> About the Data</a></li>
  <li><a href="#data-description" id="toc-data-description" class="nav-link" data-scroll-target="#data-description"><span class="header-section-number">2.2</span> Data Description</a></li>
  <li><a href="#data-visualization" id="toc-data-visualization" class="nav-link" data-scroll-target="#data-visualization"><span class="header-section-number">2.3</span> Data Visualization</a></li>
  </ul></li>
  <li><a href="#preparing-data-for-machine-learning" id="toc-preparing-data-for-machine-learning" class="nav-link" data-scroll-target="#preparing-data-for-machine-learning"><span class="header-section-number">3</span> Preparing Data For Machine Learning</a></li>
  <li><a href="#models" id="toc-models" class="nav-link" data-scroll-target="#models"><span class="header-section-number">4</span> Models</a>
  <ul class="collapse">
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression"><span class="header-section-number">4.1</span> Linear Regression</a></li>
  <li><a href="#ridge-regression" id="toc-ridge-regression" class="nav-link" data-scroll-target="#ridge-regression"><span class="header-section-number">4.2</span> Ridge Regression</a></li>
  <li><a href="#lasso-regression" id="toc-lasso-regression" class="nav-link" data-scroll-target="#lasso-regression"><span class="header-section-number">4.3</span> Lasso Regression</a></li>
  <li><a href="#random-forest" id="toc-random-forest" class="nav-link" data-scroll-target="#random-forest"><span class="header-section-number">4.4</span> Random Forest</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">5</span> Results</a>
  <ul class="collapse">
  <li><a href="#mean-squared-error-of-all-models" id="toc-mean-squared-error-of-all-models" class="nav-link" data-scroll-target="#mean-squared-error-of-all-models"><span class="header-section-number">5.1</span> Mean Squared Error of all Models</a></li>
  <li><a href="#linear-regression-results" id="toc-linear-regression-results" class="nav-link" data-scroll-target="#linear-regression-results"><span class="header-section-number">5.2</span> Linear Regression Results</a></li>
  <li><a href="#random-forest-results" id="toc-random-forest-results" class="nav-link" data-scroll-target="#random-forest-results"><span class="header-section-number">5.3</span> Random Forest Results</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion"><span class="header-section-number">6</span> Discussion</a>
  <ul class="collapse">
  <li><a href="#linear-regression-1" id="toc-linear-regression-1" class="nav-link" data-scroll-target="#linear-regression-1"><span class="header-section-number">6.1</span> Linear Regression</a>
  <ul class="collapse">
  <li><a href="#interpretations-of-statistically-significant-variables" id="toc-interpretations-of-statistically-significant-variables" class="nav-link" data-scroll-target="#interpretations-of-statistically-significant-variables"><span class="header-section-number">6.1.1</span> Interpretations of Statistically significant variables:</a></li>
  </ul></li>
  <li><a href="#random-forest-1" id="toc-random-forest-1" class="nav-link" data-scroll-target="#random-forest-1"><span class="header-section-number">6.2</span> Random Forest</a></li>
  <li><a href="#potential-policy-recommendations" id="toc-potential-policy-recommendations" class="nav-link" data-scroll-target="#potential-policy-recommendations"><span class="header-section-number">6.3</span> Potential Policy Recommendations</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">7</span> Conclusion</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">United States Car Accident Project</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jason Rappazzo, James Jordan </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 15, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="indroduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Indroduction</h1>
<p>For our capstone project we will be analyzing a Kaggle data set on car accidents in the United States. The data set contains accident reports from February 2016 through December 2021 using various APIs. There are 2.8 million accidents reported in this data set. There are 47 different features making this data set quite large. We will be using a 10% subset of the data for ease of computing.</p>
<section id="research-questions" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="research-questions"><span class="header-section-number">1.1</span> Research Questions</h2>
<p>What features are strongly associated with the severity of a car accident?</p>
<p>Which model best predicts the severity of a car accident?</p>
</section>
<section id="overview-of-modeling-techniques" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="overview-of-modeling-techniques"><span class="header-section-number">1.2</span> Overview of Modeling Techniques</h2>
<p><u> Linear Regression:</u> also known as Ordinary Least Squares (OLS) is the most simple method for regression analysis.</p>
<p>The linear regression model for predicting the severity of a car accident is:</p>
<p><span class="math display">\[\hat{y}=\hat{\beta_0} + \hat{\beta_i} \times x + \epsilon\]</span></p>
<p>where <span class="math inline">\(\hat{y}\)</span> is the predicted severity of a car accident, <span class="math inline">\(\hat{\beta_0}\)</span> is the intercept term, <span class="math inline">\(\hat{\beta_i}\)</span> is the beta estimate for each feature, and <span class="math inline">\(\epsilon\)</span> is the error term.</p>
<p>The model minimizes the mean squared error, which is written as:</p>
<p><span class="math display">\[MSE({\beta})=\frac{1}{n} \sum_{i=1}^n  \hat{\epsilon_i}^2=\frac{1}{n}\sum_{i=1}^n  (y_i-\hat{y_i})^2\]</span></p>
<p>where <span class="math inline">\(\hat{y_i}\)</span> is the predicted severity of a car accident and <span class="math inline">\(y_i\)</span> is the actual severity.</p>
<p><u> Ridge Regression: </u> A regularized version of linear regression. This is achieved by adding this equation to the loss function:</p>
<p><span class="math display">\[\sum_{i=1}^n  \beta_i^2\]</span></p>
<p>The cost function for ridge regression is as follows:</p>
<p><span class="math display">\[
(\beta) = MSE(\beta) + \frac{1}{n} \alpha \sum_{i=1}^n  \beta_i^2
\]</span></p>
<p>where <span class="math inline">\(MSE(\beta)\)</span> is the mean squared error function, <span class="math inline">\(\beta_i\)</span> is the coefficient of the <span class="math inline">\(i\)</span>-th feature, <span class="math inline">\(n\)</span> is the number of samples, and <span class="math inline">\(\alpha\)</span> is the regularization strength.</p>
<p><u> Lasso Regression: </u> Like Ridge Regression, Lasso Regression adds a regularization term to the cost function, but uses the l1 norm of the weight vector instead of half the square of the l2 norm. The cost function for Lasso Regression is as follows:</p>
<p><span class="math display">\[J(\beta) = MSE(\beta) +  \alpha \sum_{i=1}^n  |\beta_i|\]</span></p>
<p>where <span class="math inline">\(MSE(\beta)\)</span> is the mean squared error function, <span class="math inline">\(\beta_i\)</span> is the coefficient of the <span class="math inline">\(i\)</span>-th feature, <span class="math inline">\(n\)</span> is the number of samples, and <span class="math inline">\(\alpha\)</span> is the regularization strength.</p>
<p><u> Random Forest: </u> They are comprised of many slightly different decision trees. The decision trees that make up the random forest are generated randomly giving it the name Random Forest. Depending on the number of trees in the forest, this could be a highly accurate model, but could also have the tendency to over fit the data. Random Forests are one way to combat the over fitting problem that Decision Tree Models may have.</p>
</section>
</section>
<section id="raw-data" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Raw Data</h1>
<div class="cell">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; ">
<table class="table table-striped table-hover table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Severity</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Start_Time</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">End_Time</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Start_Lat</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Start_Lng</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">End_Lat</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">End_Lng</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Distance(mi)</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Description</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Number</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Street</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Side</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">City</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">County</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">State</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Zipcode</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Country</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Timezone</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Airport_Code</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Weather_Timestamp</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Temperature(F)</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Wind_Chill(F)</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Humidity(%)</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Pressure(in)</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Visibility(mi)</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Wind_Direction</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Wind_Speed(mph)</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Precipitation(in)</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Weather_Condition</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Amenity</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Bump</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Crossing</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Give_Way</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Junction</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">No_Exit</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Railway</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Roundabout</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Station</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Stop</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Traffic_Calming</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Traffic_Signal</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Turning_Loop</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Sunrise_Sunset</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Civil_Twilight</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Nautical_Twilight</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Astronomical_Twilight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: left;">2016-02-10 06:18:49</td>
<td style="text-align: left;">2016-02-10 12:18:49</td>
<td style="text-align: right;">40.72813</td>
<td style="text-align: right;">-84.78965</td>
<td style="text-align: right;">40.74559</td>
<td style="text-align: right;">-84.78962</td>
<td style="text-align: right;">1.206</td>
<td style="text-align: left;">Closed between Willshire and US-33/Rockford Rd - Road closed due to accident.</td>
<td style="text-align: right;">12998</td>
<td style="text-align: left;">State Route 49</td>
<td style="text-align: left;">R</td>
<td style="text-align: left;">Willshire</td>
<td style="text-align: left;">Van Wert</td>
<td style="text-align: left;">OH</td>
<td style="text-align: left;">45898-9523</td>
<td style="text-align: left;">US</td>
<td style="text-align: left;">US/Eastern</td>
<td style="text-align: left;">KFWA</td>
<td style="text-align: left;">2016-02-10 05:54:00</td>
<td style="text-align: right;">17.1</td>
<td style="text-align: right;">0.6</td>
<td style="text-align: right;">77</td>
<td style="text-align: right;">29.91</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: left;">West</td>
<td style="text-align: right;">19.6</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">Light Snow</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Day</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">2016-02-15 20:46:40</td>
<td style="text-align: left;">2016-02-16 02:46:40</td>
<td style="text-align: right;">38.82493</td>
<td style="text-align: right;">-85.47450</td>
<td style="text-align: right;">38.82415</td>
<td style="text-align: right;">-85.63794</td>
<td style="text-align: right;">8.798</td>
<td style="text-align: left;">Closed between US-421 and IN-3 - Road closed due to accident.</td>
<td style="text-align: right;">4722</td>
<td style="text-align: left;">W State Road 250</td>
<td style="text-align: left;">R</td>
<td style="text-align: left;">Madison</td>
<td style="text-align: left;">Jefferson</td>
<td style="text-align: left;">IN</td>
<td style="text-align: left;">47250</td>
<td style="text-align: left;">US</td>
<td style="text-align: left;">US/Eastern</td>
<td style="text-align: left;">KLOU</td>
<td style="text-align: left;">2016-02-15 20:53:00</td>
<td style="text-align: right;">37.0</td>
<td style="text-align: right;">34.5</td>
<td style="text-align: right;">96</td>
<td style="text-align: right;">29.85</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">NNW</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: left;">Overcast</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Night</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: left;">2016-02-25 13:13:48</td>
<td style="text-align: left;">2016-02-25 19:13:48</td>
<td style="text-align: right;">39.96720</td>
<td style="text-align: right;">-81.28700</td>
<td style="text-align: right;">39.96392</td>
<td style="text-align: right;">-81.27197</td>
<td style="text-align: right;">0.828</td>
<td style="text-align: left;">Closed between Inglenook Ln and Eldon Rd - Road closed due to accident.</td>
<td style="text-align: right;">24288</td>
<td style="text-align: left;">Leatherwood Rd</td>
<td style="text-align: left;">L</td>
<td style="text-align: left;">Quaker City</td>
<td style="text-align: left;">Guernsey</td>
<td style="text-align: left;">OH</td>
<td style="text-align: left;">43773-9690</td>
<td style="text-align: left;">US</td>
<td style="text-align: left;">US/Eastern</td>
<td style="text-align: left;">KZZV</td>
<td style="text-align: left;">2016-02-25 13:12:00</td>
<td style="text-align: right;">37.0</td>
<td style="text-align: right;">28.5</td>
<td style="text-align: right;">79</td>
<td style="text-align: right;">29.66</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: left;">West</td>
<td style="text-align: right;">13.8</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: left;">Light Snow</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Day</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">2016-05-09 13:07:53</td>
<td style="text-align: left;">2016-05-09 19:07:53</td>
<td style="text-align: right;">35.52718</td>
<td style="text-align: right;">-121.04482</td>
<td style="text-align: right;">35.55134</td>
<td style="text-align: right;">-121.07163</td>
<td style="text-align: right;">2.249</td>
<td style="text-align: left;">At Ardath Dr - Accident.</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Cabrillo Hwy</td>
<td style="text-align: left;">R</td>
<td style="text-align: left;">Cambria</td>
<td style="text-align: left;">San Luis Obispo</td>
<td style="text-align: left;">CA</td>
<td style="text-align: left;">93428-6012</td>
<td style="text-align: left;">US</td>
<td style="text-align: left;">US/Pacific</td>
<td style="text-align: left;">K87Q</td>
<td style="text-align: left;">2016-05-09 12:56:00</td>
<td style="text-align: right;">71.0</td>
<td style="text-align: right;">71.0</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">29.75</td>
<td style="text-align: right;">10.0</td>
<td style="text-align: left;">NW</td>
<td style="text-align: right;">16.0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: left;">Fair</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Day</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">2016-05-25 19:55:24</td>
<td style="text-align: left;">2016-05-26 01:55:24</td>
<td style="text-align: right;">34.34927</td>
<td style="text-align: right;">-118.53723</td>
<td style="text-align: right;">34.34927</td>
<td style="text-align: right;">-118.53723</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">Between Calgrove Blvd/Exit 166 and CA-14/Exit 162 - Accident.</td>
<td style="text-align: right;">23500</td>
<td style="text-align: left;">The Old Rd</td>
<td style="text-align: left;">R</td>
<td style="text-align: left;">Newhall</td>
<td style="text-align: left;">Los Angeles</td>
<td style="text-align: left;">CA</td>
<td style="text-align: left;">91321-3910</td>
<td style="text-align: left;">US</td>
<td style="text-align: left;">US/Pacific</td>
<td style="text-align: left;">K3A6</td>
<td style="text-align: left;">2016-05-25 19:51:00</td>
<td style="text-align: right;">63.0</td>
<td style="text-align: right;">63.0</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">29.19</td>
<td style="text-align: right;">10.0</td>
<td style="text-align: left;">VAR</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: left;">Partly Cloudy</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Day</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">2016-05-26 20:05:53</td>
<td style="text-align: left;">2016-05-27 02:05:53</td>
<td style="text-align: right;">34.49062</td>
<td style="text-align: right;">-118.61760</td>
<td style="text-align: right;">34.49062</td>
<td style="text-align: right;">-118.61760</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">Approaching at Castaic Rd - Accident.</td>
<td style="text-align: right;">31472</td>
<td style="text-align: left;">Castaic Rd</td>
<td style="text-align: left;">L</td>
<td style="text-align: left;">Castaic</td>
<td style="text-align: left;">Los Angeles</td>
<td style="text-align: left;">CA</td>
<td style="text-align: left;">91384-3915</td>
<td style="text-align: left;">US</td>
<td style="text-align: left;">US/Pacific</td>
<td style="text-align: left;">K3A6</td>
<td style="text-align: left;">2016-05-26 19:51:00</td>
<td style="text-align: right;">65.0</td>
<td style="text-align: right;">65.0</td>
<td style="text-align: right;">58</td>
<td style="text-align: right;">29.09</td>
<td style="text-align: right;">10.0</td>
<td style="text-align: left;">SE</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: left;">Fair</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Day</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<section id="about-the-data" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="about-the-data"><span class="header-section-number">2.1</span> About the Data</h2>
<p>The target variable that we will be using is called “Severity” which indicates the severity of the accident scored on a numeric scale from 1-4. A score of 1 would indicate that the accident was not severe and had a little impact on traffic whereas a 4 would mean the accident had a large impact on traffic and was highly severe. We do not plan on utilizing all of the features provided in the data set. Instead we will only be using 11 in our models. The features include “State”, “Temperature(F)”, “Humidity(%)”, “Visibility(mi)”, “Wind_Speed(mph)”, “Weather_Condition”, “Precipitation(in)”, “Crossing”, “Junction”, “Traffic_Signal”, and “Sunrise_Sunset”. Using these variables in conjunction with supervised machine learning techniques, we will be able to predict the severity of a certain accident.</p>
</section>
<section id="data-description" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="data-description"><span class="header-section-number">2.2</span> Data Description</h2>
<p><u> State:</u> Shows the state in address field.</p>
<p><u>Temperature(F):</u> Shows the temperature (in Fahrenheit).</p>
<p><u>Humidity(%):</u> Shows the humidity (in percentage).</p>
<p><u>Visibility(mi):</u> Shows visibility (in miles).</p>
<p><u>Wind_Speed(mph):</u> Shows wind speed (in miles per hour).</p>
<p><u>Weather_Condition:</u> Shows the weather condition (rain, snow, thunderstorm, fog, etc.).</p>
<p><u>Precipitation(in):</u> Shows precipitation amount in inches, if there is any.</p>
<p><u>Crossing:</u> A POI annotation which indicates presence of crossing in a nearby location.</p>
<p><u>Junction:</u> A POI annotation which indicates presence of junction in a nearby location.</p>
<p><u>Traffic_Signal:</u> A POI annotation which indicates presence of traffic_signal in a nearby location</p>
<p><u>Sunrise_Sunset:</u> Shows the period of day (i.e.&nbsp;day or night) based on sunrise/sunset.</p>
</section>
<section id="data-visualization" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="data-visualization"><span class="header-section-number">2.3</span> Data Visualization</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="capstone_project_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Most of the car accidents recorded had a severity score of 2 out of the highest posible 4. The data is not balanced.</p>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="capstone_project_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>The highest amount of car accidents in this particular data set came from Florida and California each with over 20,000 separate accidents.</p>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="capstone_project_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>This graph shows that weather condition does not have that much of an impact on severity level. Each of the severity levels showed very high proportions of fair weather.</p>
<p><br></p>
</section>
</section>
<section id="preparing-data-for-machine-learning" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Preparing Data For Machine Learning</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>accident_12var <span class="ot">&lt;-</span> accident_raw <span class="sc">%&gt;%</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Severity,State, <span class="st">`</span><span class="at">Temperature(F)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Humidity(%)</span><span class="st">`</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Visibility(mi)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Wind_Speed(mph)</span><span class="st">`</span>, Weather_Condition,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Precipitation(in)</span><span class="st">`</span>, Crossing, Junction, Traffic_Signal,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>         Sunrise_Sunset)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(accident_12var) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">)|</span><span class="sc">\\</span><span class="st">%|</span><span class="sc">\\</span><span class="st">("</span>, <span class="st">"."</span>, <span class="fu">colnames</span>(accident_12var))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(recipes)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into training and testing sets</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(accident_12var<span class="sc">$</span>Severity, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>train_set <span class="ot">&lt;-</span> accident_12var[train_indices, ]</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>test_set <span class="ot">&lt;-</span> accident_12var[<span class="sc">-</span>train_indices, ]</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># TRAIN SET</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a copy of the train set</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>copied_traindata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(train_set)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Add an id column to copied_traindata</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>copied_traindata <span class="ot">&lt;-</span> copied_traindata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>())</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate Label from Feature</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>accident <span class="ot">&lt;-</span> <span class="fu">select</span>(copied_traindata, <span class="sc">-</span>Severity) <span class="co"># drop Severity column</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>label <span class="ot">&lt;-</span> copied_traindata<span class="sc">$</span>Severity <span class="co"># select Severity column</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate Numerical from Categorical</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>accident_num <span class="ot">&lt;-</span> accident <span class="sc">%&gt;%</span> </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, Temperature.F., Humidity..., Visibility.mi., Wind_Speed.mph., Precipitation.in.)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>accident_cat <span class="ot">&lt;-</span> accident <span class="sc">%&gt;%</span> </span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, State, Weather_Condition, Crossing, Junction, Traffic_Signal, Sunrise_Sunset)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Define numeric and categorical attributes</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>num_attribs <span class="ot">&lt;-</span> <span class="fu">names</span>(accident_num)[<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>cat_attribs <span class="ot">&lt;-</span> <span class="fu">names</span>(accident_cat)[<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Define preprocessing pipelines</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>num_pipeline <span class="ot">&lt;-</span> <span class="fu">recipe</span>(<span class="sc">~</span>., <span class="at">data =</span> accident_num) <span class="sc">%&gt;%</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_median</span>(<span class="fu">all_numeric</span>(), <span class="sc">-</span><span class="fu">has_role</span>(<span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_center</span>(<span class="fu">all_numeric</span>(), <span class="sc">-</span><span class="fu">has_role</span>(<span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_scale</span>(<span class="fu">all_numeric</span>(), <span class="sc">-</span><span class="fu">has_role</span>(<span class="st">"id"</span>))</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>cat_pipeline <span class="ot">&lt;-</span> <span class="fu">recipe</span>(<span class="sc">~</span>., <span class="at">data =</span> accident_cat) <span class="sc">%&gt;%</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>())</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the preprocessed numerical and categorical features into a single dataset</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>accident <span class="ot">&lt;-</span> accident <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Index =</span> id) </span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(num_pipeline <span class="sc">%&gt;%</span> <span class="fu">prep</span>() <span class="sc">%&gt;%</span> <span class="fu">bake</span>(<span class="at">new_data =</span> <span class="cn">NULL</span>), <span class="at">join_key =</span> <span class="st">"Index"</span>)</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(cat_pipeline <span class="sc">%&gt;%</span> <span class="fu">prep</span>() <span class="sc">%&gt;%</span> <span class="fu">bake</span>(<span class="at">new_data =</span> <span class="cn">NULL</span>), <span class="at">join_key =</span> <span class="st">"Index"</span>)</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>accident_prepared <span class="ot">&lt;-</span> accident <span class="sc">%&gt;%</span> </span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">one_of</span>(<span class="fu">c</span>(cat_attribs, num_attribs)))</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>accident_prepared <span class="ot">&lt;-</span> <span class="fu">cbind</span>(accident_prepared, df1,df2)</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>accident_prepared <span class="ot">&lt;-</span> accident_prepared <span class="sc">%&gt;%</span> </span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>accident_prepared <span class="ot">&lt;-</span> <span class="fu">select</span>(accident_prepared, <span class="sc">-</span><span class="fu">c</span>(<span class="st">"Index"</span>, <span class="st">"id"</span>, <span class="st">"join_key"</span>, <span class="st">"id.1"</span>, <span class="st">"join_key.1"</span>))</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a><span class="co">#TEST SET</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a copy of the test set</span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>copied_testdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(test_set)</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Add an id column to copied_testdata</span></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>copied_testdata <span class="ot">&lt;-</span> copied_testdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>())</span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate Label from Feature</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>accident_test <span class="ot">&lt;-</span> <span class="fu">select</span>(copied_testdata, <span class="sc">-</span>Severity) <span class="co"># drop Severity column</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>label_test <span class="ot">&lt;-</span> copied_testdata<span class="sc">$</span>Severity <span class="co"># select Severity column</span></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate Numerical from Categorical</span></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>accident_num_test <span class="ot">&lt;-</span> copied_testdata <span class="sc">%&gt;%</span> </span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Temperature.F., Humidity..., Visibility.mi., Wind_Speed.mph., Precipitation.in.)</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>accident_cat_test <span class="ot">&lt;-</span> copied_testdata <span class="sc">%&gt;%</span> </span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(State, Weather_Condition, Crossing, Junction, Traffic_Signal, Sunrise_Sunset)</span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a><span class="co"># Define numeric and categorical attributes</span></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>num_attribs <span class="ot">&lt;-</span> <span class="fu">names</span>(accident_num_test)[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>cat_attribs <span class="ot">&lt;-</span> <span class="fu">names</span>(accident_cat_test)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Define preprocessing pipelines</span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>num_pipeline <span class="ot">&lt;-</span> <span class="fu">recipe</span>(<span class="sc">~</span>., <span class="at">data =</span> accident_num_test) <span class="sc">%&gt;%</span></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_median</span>(<span class="fu">all_numeric</span>(), <span class="sc">-</span><span class="fu">has_role</span>(<span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_center</span>(<span class="fu">all_numeric</span>(), <span class="sc">-</span><span class="fu">has_role</span>(<span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_scale</span>(<span class="fu">all_numeric</span>(), <span class="sc">-</span><span class="fu">has_role</span>(<span class="st">"id"</span>))</span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>cat_pipeline <span class="ot">&lt;-</span> <span class="fu">recipe</span>(<span class="sc">~</span>., <span class="at">data =</span> accident_cat_test) <span class="sc">%&gt;%</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>())</span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the preprocessed numerical and categorical features into a single dataset</span></span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>copied_testdata <span class="ot">&lt;-</span> copied_testdata <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Index =</span> id) </span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(num_pipeline <span class="sc">%&gt;%</span> <span class="fu">prep</span>() <span class="sc">%&gt;%</span> <span class="fu">bake</span>(<span class="at">new_data =</span> <span class="cn">NULL</span>), <span class="at">join_key =</span> <span class="st">"Index"</span>)</span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(cat_pipeline <span class="sc">%&gt;%</span> <span class="fu">prep</span>() <span class="sc">%&gt;%</span> <span class="fu">bake</span>(<span class="at">new_data =</span> <span class="cn">NULL</span>), <span class="at">join_key =</span> <span class="st">"Index"</span>)</span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>accident_prepared_test <span class="ot">&lt;-</span> accident_test <span class="sc">%&gt;%</span> </span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">one_of</span>(<span class="fu">c</span>(cat_attribs, num_attribs)))</span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>accident_prepared_test <span class="ot">&lt;-</span> <span class="fu">cbind</span>(accident_prepared_test, df1,df2)</span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>accident_prepared_test <span class="ot">&lt;-</span> accident_prepared_test <span class="sc">%&gt;%</span> </span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>accident_prepared_test <span class="ot">&lt;-</span> <span class="fu">select</span>(accident_prepared_test, <span class="sc">-</span><span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"join_key"</span>, <span class="st">"join_key.1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="models" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Models</h1>
<section id="linear-regression" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="linear-regression"><span class="header-section-number">4.1</span> Linear Regression</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>lin_reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(label <span class="sc">~</span> ., <span class="at">data =</span> accident_prepared)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ridge-regression" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="ridge-regression"><span class="header-section-number">4.2</span> Ridge Regression</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> label</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">select</span>(accident_prepared, <span class="sc">-</span>label))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>lambda_seq <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="dv">10</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="at">length =</span> <span class="dv">100</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>ridge_fit <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(X, y, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">lambda =</span> lambda_seq)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ridge_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="capstone_project_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ridge_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(ridge_fit)[<span class="sc">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="lasso-regression" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="lasso-regression"><span class="header-section-number">4.3</span> Lasso Regression</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> ., <span class="at">data =</span> accident_prepared) </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> label</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a Lasso regression with cross-validation</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>lasso_model <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x, y, <span class="at">alpha =</span> <span class="dv">1</span>) </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>extra_columns <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">colnames</span>(accident_prepared_test), <span class="fu">colnames</span>(accident_prepared))</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>accident_prepared_test <span class="ot">&lt;-</span> accident_prepared_test <span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">select</span>(<span class="sc">-</span><span class="fu">one_of</span>(extra_columns))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="random-forest" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="random-forest"><span class="header-section-number">4.4</span> Random Forest</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>accident_forest <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(label <span class="sc">~</span> ., <span class="at">data =</span> accident_prepared, <span class="at">ntree =</span> <span class="dv">10</span>, <span class="at">mtry =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="results" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Results</h1>
<section id="mean-squared-error-of-all-models" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="mean-squared-error-of-all-models"><span class="header-section-number">5.1</span> Mean Squared Error of all Models</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression Mean Squared Error: 0.1256516</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Ridge Regression Mean Squared Error: 0.1307262</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Lasso Regression Mean Squared Error: 0.1281963</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Random Forest Mean Squared Error: 0.1251018</code></pre>
</div>
</div>
<p>All of the models had very similar mean squared errors of around 0.13, but the best two models for predicting the severity of a car accident is the linear regression and random forest. The had slightly lower mean squared errors compared to the ridge and lasso regression models.</p>
</section>
<section id="linear-regression-results" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="linear-regression-results"><span class="header-section-number">5.2</span> Linear Regression Results</h2>
<div class="cell">
<pre><code>## 
## Linear Regression Results
## =====================================================================
##                                            Severity of Car Accident  
##                                           ---------------------------
##                                                      label           
## ---------------------------------------------------------------------
## Temperature.F.                              0.003 (-0.0001, 0.006)   
## Humidity...                                 0.007*** (0.004, 0.010)  
## Visibility.mi.                              0.0002 (-0.003, 0.003)   
## Wind_Speed.mph.                            -0.003* (-0.006, -0.0003) 
## Precipitation.in.                           -0.001 (-0.003, 0.002)   
## Crossing                                  -0.031*** (-0.038, -0.024) 
## Junction                                     0.023 (-0.010, 0.056)   
## Traffic_Signal                            -0.017*** (-0.023, -0.010) 
## State_AR                                    0.209*** (0.161, 0.257)  
## State_AZ                                  -0.204*** (-0.237, -0.171) 
## State_CA                                  -0.128*** (-0.157, -0.098) 
## State_CO                                    0.507*** (0.461, 0.553)  
## State_CT                                    0.459*** (0.410, 0.507)  
## State_DC                                     0.042 (-0.005, 0.088)   
## State_DE                                    0.287*** (0.228, 0.346)  
## State_FL                                  -0.122*** (-0.152, -0.093) 
## State_GA                                    0.563*** (0.511, 0.614)  
## State_IA                                    0.407*** (0.343, 0.470)  
## State_ID                                    -0.011 (-0.057, 0.035)   
## State_IL                                    0.287*** (0.252, 0.323)  
## State_IN                                    0.606*** (0.553, 0.658)  
## State_KS                                    0.374*** (0.258, 0.489)  
## State_KY                                     0.012 (-0.057, 0.082)   
## State_LA                                  -0.143*** (-0.175, -0.111) 
## State_MA                                    0.523*** (0.425, 0.621)  
## State_MD                                    0.102*** (0.068, 0.137)  
## State_ME                                     0.072 (-0.088, 0.233)   
## State_MI                                    0.056*** (0.021, 0.091)  
## State_MN                                  -0.124*** (-0.156, -0.092) 
## State_MO                                   -0.061** (-0.104, -0.018) 
## State_MS                                     0.028 (-0.054, 0.109)   
## State_MT                                  -0.125*** (-0.162, -0.088) 
## State_NC                                   -0.046** (-0.076, -0.015) 
## State_ND                                   -0.141** (-0.248, -0.035) 
## State_NE                                    0.648*** (0.555, 0.740)  
## State_NH                                     0.019 (-0.111, 0.148)   
## State_NJ                                    0.226*** (0.188, 0.264)  
## State_NM                                    0.571*** (0.382, 0.760)  
## State_NV                                     0.079 (-0.001, 0.160)   
## State_NY                                    0.104*** (0.072, 0.136)  
## State_OH                                    -0.002 (-0.041, 0.037)   
## State_OK                                    -0.024 (-0.066, 0.019)   
## State_OR                                  -0.092*** (-0.122, -0.061) 
## State_PA                                    -0.015 (-0.046, 0.015)   
## State_SC                                  -0.115*** (-0.145, -0.085) 
## State_SD                                     0.198* (0.008, 0.387)   
## State_TN                                  -0.125*** (-0.157, -0.092) 
## State_TX                                  -0.119*** (-0.149, -0.089) 
## State_UT                                  -0.094*** (-0.129, -0.059) 
## State_VA                                    0.047** (0.016, 0.079)   
## State_WA                                    0.152*** (0.112, 0.191)  
## State_WI                                    1.377*** (1.282, 1.472)  
## State_WV                                    -0.009 (-0.079, 0.061)   
## Weather_Condition_Cloudy...Windy             0.038 (-0.007, 0.082)   
## Weather_Condition_Drizzle                   -0.033 (-0.123, 0.058)   
## Weather_Condition_Fair                      -0.0001 (-0.007, 0.007)  
## Weather_Condition_Fair...Windy               0.024 (-0.004, 0.052)   
## Weather_Condition_Fog                       -0.007 (-0.027, 0.014)   
## Weather_Condition_Haze                       0.011 (-0.010, 0.032)   
## Weather_Condition_Haze...Windy               0.050 (-0.090, 0.190)   
## Weather_Condition_Heavy.Rain                 0.010 (-0.035, 0.054)   
## Weather_Condition_Heavy.Snow                 0.014 (-0.093, 0.121)   
## Weather_Condition_Heavy.T.Storm              0.049 (-0.008, 0.106)   
## Weather_Condition_Light.Drizzle              0.027 (-0.028, 0.082)   
## Weather_Condition_Light.Rain                0.018** (0.005, 0.030)   
## Weather_Condition_Light.Rain...Windy         0.069* (0.004, 0.134)   
## Weather_Condition_Light.Rain.with.Thunder    0.006 (-0.037, 0.050)   
## Weather_Condition_Light.Snow                0.051*** (0.029, 0.074)  
## Weather_Condition_Light.Snow...Windy        -0.016 (-0.110, 0.078)   
## Weather_Condition_Mostly.Cloudy            -0.013** (-0.021, -0.004) 
## Weather_Condition_Mostly.Cloudy...Windy      0.032 (-0.011, 0.075)   
## Weather_Condition_N.A.Precipitation         -0.081 (-0.195, 0.034)   
## Weather_Condition_Overcast                  0.665*** (0.603, 0.727)  
## Weather_Condition_Partly.Cloudy             -0.0005 (-0.010, 0.009)  
## Weather_Condition_Partly.Cloudy...Windy      0.071* (0.011, 0.131)   
## Weather_Condition_Patches.of.Fog            -0.060 (-0.189, 0.069)   
## Weather_Condition_Rain                      -0.011 (-0.039, 0.016)   
## Weather_Condition_Rain...Windy              -0.108 (-0.219, 0.003)   
## Weather_Condition_Smoke                      0.045* (0.005, 0.084)   
## Weather_Condition_Snow                      0.078** (0.014, 0.143)   
## Weather_Condition_T.Storm                    0.030 (-0.010, 0.071)   
## Weather_Condition_Thunder                    0.012 (-0.026, 0.050)   
## Weather_Condition_Thunder.in.the.Vicinity   -0.005 (-0.042, 0.032)   
## Weather_Condition_Wintry.Mix                -0.006 (-0.072, 0.060)   
## Sunrise_Sunset_Night                        0.010*** (0.005, 0.015)  
## Constant                                    2.139*** (2.109, 2.168)  
## =====================================================================
## =====================================================================
## Note:                                     *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="capstone_project_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="capstone_project_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="capstone_project_files/figure-html/unnamed-chunk-15-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="capstone_project_files/figure-html/unnamed-chunk-15-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="capstone_project_files/figure-html/unnamed-chunk-15-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="capstone_project_files/figure-html/unnamed-chunk-15-6.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="random-forest-results" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="random-forest-results"><span class="header-section-number">5.3</span> Random Forest Results</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="capstone_project_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</section>
</section>
<section id="discussion" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Discussion</h1>
<section id="linear-regression-1" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="linear-regression-1"><span class="header-section-number">6.1</span> Linear Regression</h2>
<p>When looking at the beta estimates provided by our Linear Regression model, there were 41 variables that returned a p-value of less than 0.01. This indicates that these variables were statistically significant. These include: <br></p>
<p>Humidity <br> Crossing <br> Traffic Signal <br> Several States <br> Light Drizzle/Windy <br> Light Freezing rain/windy <br> Ice Pellets <br> Overcast Conditions <br> Smoky, Windy Conditions <br> Sunrise/Sunset/Night</p>
<section id="interpretations-of-statistically-significant-variables" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="interpretations-of-statistically-significant-variables"><span class="header-section-number">6.1.1</span> Interpretations of Statistically significant variables:</h3>
<p>Humidity had a beta estimate of 0.007, which means that as humidity percentage increases by one percentage point, severity increases by 0.007. <br></p>
<p>If there is a crosswalk nearby, the severity of an accident decreases by 0.036 percent <br></p>
<p>If there is a traffic signal nearby, the severity of the accident decreases by 0.014 <br></p>
<p>The highest beta estimate magnitude had to do with the state in which an accident occurred. The state with the highest impact on accident severity is Wisconsin. The severity of an accident increases by 1.43 if the accident occurred in Wisconsin. Arizona has a beta estimate of -0.199, the lowest of the states surveyed. This means that if an accident were to occur in Arizona, the severity decreases by 0.199. <br></p>
<p>If there is a light drizzle of rain, mixed with windy conditions, the severity of accidents is expected to increase by 0.659 <br></p>
<p>If there is light freezing rain mixed with windy conditions, the severity of an accident is expected to increase by 0.871.</p>
</section>
</section>
<section id="random-forest-1" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="random-forest-1"><span class="header-section-number">6.2</span> Random Forest</h2>
<p>Looking at the variance importance plot, we can see that being in a particular state had the most importance in predicting the severity of the accident. Of all the variables 21 out of the top 30 most important variable all involved what state you are in. Some of the other important variables that are not related are temperature, humidity, wind speed, traffic light presence, visibility, and precipitation.</p>
</section>
<section id="potential-policy-recommendations" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="potential-policy-recommendations"><span class="header-section-number">6.3</span> Potential Policy Recommendations</h2>
<p>There are a couple of potential reasons why Wisconsin suffers the most severe car accidents. One of these reasons is that Wisconsin is subject to extreme weather (lots of rain and snow) that can cause dangerous road conditions, thus contributing to fatal car accidents. When looking at a study by Mingo &amp; Yankala, it is shown that five of the nine deadliest road segments in the state of Wisconsin are located in Milwaukee, which is Wisconsin’s most densely populated area. The way that these roads are constructed potentially contributes to the number of severe car accidents that occur. Each of these segments intersects with another main road or highway or has an interchange with an interstate. One potential way to combat the prominence of severe car accidents on these segments is to decrease the speed limit on these stretches of roads, especially where they intersect/interchange with other main roads. Wisconsin is also the 10th worst state when it comes to arrests/fatalities for driving under the influence. Wisconsin should look to hand out more severe punishment for DUI charges in order to attempt to prevent this risky behavior. <a href="https://www.mysclaw.com/the-deadliest-road-stretches-in-wisconsin/#:~:text=Heavily%20trafficked%20roads%20such%20as,higher%20incident%20rate%20of%20accidents" class="uri">https://www.mysclaw.com/the-deadliest-road-stretches-in-wisconsin/#:~:text=Heavily%20trafficked%20roads%20such%20as,higher%20incident%20rate%20of%20accidents</a></p>
<p><br></p>
<p>Although New Hampshire does not have areas as densely populated as a metropolitan area such as Milwaukee, there are glaring reasons why accidents tend to be more severe. According to Tenn and Tenn, Attorneys at law, New Hampshire struggles to maintain the conditions of their roads. While other state governments may handle poor road conditions quickly and properly, unfortunately, New Hampshire does not. Many of the roads in New Hampshire are cracked/broken, and feature overgrown plant life. There are poor road designs in New Hampshire and many potholes. One large issue with many New Hampshire roads is that they feature curves that are not marked by road signs. One policy suggestion that we have for New Hampshire to combat its severe car accident problem is to mark winding, curved roads with road signs. New Hampshire’s state and local governments must also make more of an effort to fix roads that are damaged by weather, and car accidents at a much faster pace, rather than leaving these hazardous conditions to cause even more accidents. <a href="https://www.tennandtenn.com/car-accidents/dangerous-road-conditions/" class="uri">https://www.tennandtenn.com/car-accidents/dangerous-road-conditions/</a></p>
<p><br></p>
<p>While investigating why many of the states with the highest likelihood for an accident to be severe, the overwhelming majority of these states cite speeding, distracted driving (cell phones), weather, drowsiness, and drunk driving as the main reasons for the severity of their accidents. While there is no reasonable way to completely eliminate these severe accidents through policy, state and local governments can make more of an effort to promote the laws that are already in place. For example, state and local governments can issue higher, more severe penalties for driving under the influence, and being caught on your phone while driving. Also, state and local governments can again make more of an effort to keep their roads in the best condition possible by removing debris, filling potholes, and making sure that adequate street signs are in place to point out potentially hazardous road conditions.</p>
</section>
</section>
<section id="conclusion" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Conclusion</h1>
<p>Linear regression and random forest models are the best models to predict the severity of a car accident out of the four models tested. Some of the most highest impact variables are the state the accident occurs in, temperature, humidity, and wind speed. These models yielded some surprising results. I assumed that different weather conditions would play a much larger role in the severity of the accident, specifically snowy/mixed precipitation conditions. In future research, I would like to make sure the data is balanced before we start training the models. In the graph of the frequency of each severity accident, the data had a very lopsided numbers of each severity level. This may have had a large impact on the models. 
<script type="application/shiny-prerendered" data-context="server-start">
library(tidyverse)
library(skimr)   # a better summary of data.frame
library(scales)  # scales for ggplot
library(ggthemes)  # additional ggplot themes
theme_set(theme_minimal()) # setting the minimal theme for ggplot
# setting default chunk options
knitr::opts_chunk$set(echo = T, eval = T,
                      message=F, warning = F) 
</script>
 
<script type="application/shiny-prerendered" data-context="server-extras">
ojs_define <- function(..., .session = shiny::getDefaultReactiveDomain()) {
  quos <- rlang::enquos(...)
  vars <- rlang::list2(...)
  nm <- names(vars)
  if (is.null(nm)) {
    nm <- rep_len("", length(vars))
  }
  mapply(function(q, nm, val) {
    # Infer name, if possible
    if (nm == "") {
      tryCatch({
        nm <- rlang::as_name(q)
      }, error = function(e) {
        code <- paste(collapse = "\n", deparse(rlang::f_rhs(q)))
        stop("ojs_define() could not create a name for the argument: ", code)
      })
    }
    .session$output[[nm]] <- val
    outputOptions(.session$output, nm, suspendWhenHidden = FALSE)
    .session$sendCustomMessage("ojs-export", list(name = nm))
    NULL
  }, quos, nm, vars, SIMPLIFY = FALSE, USE.NAMES = FALSE)
  invisible()
}
</script>
</p>
<!--html_preserve-->

<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["kePrint"]},{"type":"character","attributes":{},"value":["0.0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["kePrint-0.0.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["kePrint.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["kableExtra"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.3.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["lightable"]},{"type":"character","attributes":{},"value":["0.0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lightable-0.0.1"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["lightable.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["kableExtra"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.3.4"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->

<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132]}},"value":[{"type":"character","attributes":{},"value":["assertthat","backports","base","base64enc","bit","bit64","broom","caret","cellranger","class","cli","codetools","coefplot","colorspace","compiler","crayon","data.table","datasets","DBI","dbplyr","digest","dplyr","ellipsis","evaluate","fansi","farver","fastmap","forcats","foreach","fs","future","future.apply","generics","ggplot2","ggthemes","glmnet","globals","glue","gower","graphics","grDevices","grid","gtable","hardhat","haven","highr","hms","htmltools","htmlwidgets","httpuv","httr","ipred","iterators","janeaustenr","jsonlite","kableExtra","knitr","labeling","later","lattice","lava","lifecycle","listenv","lubridate","magrittr","MASS","Matrix","methods","mime","ModelMetrics","modelr","munsell","nlme","nnet","parallel","parallelly","pillar","pkgconfig","plyr","pROC","prodlim","promises","purrr","R6","randomForest","Rcpp","readr","readxl","recipes","repr","reprex","reshape2","rlang","rmarkdown","rpart","rstudioapi","rvest","scales","shape","shiny","skimr","SnowballC","splines","stargazer","stats","stats4","stringi","stringr","survival","svglite","systemfonts","tibble","tidyr","tidyselect","tidytext","tidyverse","timeDate","tokenizers","tools","tzdb","useful","utf8","utils","vctrs","viridisLite","vroom","webshot","withr","xfun","xml2","xtable","yaml"]},{"type":"character","attributes":{},"value":["0.2.1","1.4.1","4.2.0","0.1-3","4.0.4","4.0.5","0.8.0","6.0-94","1.1.0","7.3-20","3.6.1","0.2-18","1.2.8","2.0-3","4.2.0","1.5.1","1.14.2","4.2.0","1.1.2","2.1.1","0.6.29","1.1.2","0.3.2","0.15","1.0.3","2.1.0","1.1.0","0.5.1","1.5.2","1.5.2","1.32.0","1.10.0","0.1.2","3.3.6","4.2.4","4.1-4","0.16.2","1.6.2","1.0.1","4.2.0","4.2.0","4.2.0","0.3.0","1.3.0","2.4.3","0.9","1.1.1","0.5.2","1.5.4","1.6.5","1.4.3","0.9-14","1.0.14","1.0.0","1.8.0","1.3.4","1.39","0.4.2","1.3.0","0.20-45","1.7.2.1","1.0.3","0.9.0","1.8.0","2.0.3","7.3-56","1.4-1","4.2.0","0.12","1.2.2.2","0.1.8","0.5.0","3.1-157","7.3-17","4.2.0","1.35.0","1.9.0","2.0.3","1.8.7","1.18.2","2023.03.31","1.2.0.1","1.0.1","2.5.1","4.7-1.1","1.0.8.3","2.1.2","1.4.0","1.0.6","1.1.4","2.0.1","1.4.4","1.1.0","2.21","4.1.16","0.13","1.0.2","1.2.0","1.4.6","1.7.1","2.1.4","0.7.1","4.2.0","5.2.3","4.2.0","4.2.0","1.7.6","1.4.0","3.3-1","2.1.0","1.0.4","3.2.1","1.2.0","1.2.0","0.4.1","1.3.1","4022.108","0.3.0","4.2.0","0.3.0","1.2.6","1.2.2","4.2.0","0.6.2","0.4.0","1.5.7","0.5.3","2.5.0","0.38","1.3.3","1.8-4","2.3.5"]}]}]}
</script>
<!--/html_preserve-->


</section>

</main> <!-- /main -->
<script type="text/javascript" src="links.js"></script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Copyright 2023</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>